<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Laundry Management System</title>
    <!-- Include a simple CSS framework for quick styling -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="styles.css">
    <!-- Firebase SDKs -->
    <script type="module" src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app.js"></script>
    <script type="module" src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore.js"></script>
    <!-- For sending messages via cloud functions we may need auth -->
    <script type="module" src="https://www.gstatic.com/firebasejs/9.22.0/firebase-functions.js"></script>
</head>
<body>
    <div class="container-fluid">
        <div class="row flex-nowrap">
            <!-- Sidebar Navigation -->
            <nav id="sidebar" class="col-auto col-md-3 col-xl-2 px-sm-2 px-0 bg-light border-end">
                <div class="d-flex flex-column align-items-center align-items-sm-start px-3 pt-2 text-dark min-vh-100">
                    <a href="#" class="d-flex align-items-center pb-3 mb-md-0 me-md-auto text-decoration-none">
                        <span class="fs-5 fw-bold">LMS</span>
                    </a>
                    <ul class="nav nav-pills flex-column mb-sm-auto mb-0 align-items-center align-items-sm-start" id="menu">
                        <li class="nav-item">
                            <a href="#" class="nav-link link-dark active" id="nav-customers" aria-current="page">
                                <span data-lang="navCustomers">Customers</span>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="#" class="nav-link link-dark" id="nav-services">
                                <span data-lang="navServices">Services</span>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="#" class="nav-link link-dark" id="nav-visits">
                                <span data-lang="navVisits">Visits</span>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="#" class="nav-link link-dark" id="nav-reports">
                                <span data-lang="navReports">Reports</span>
                            </a>
                        </li>
                    </ul>
                    <hr>
                    <!-- Language selector -->
                    <div class="dropdown pb-4">
                        <a href="#" class="d-flex align-items-center text-dark text-decoration-none dropdown-toggle" id="dropdownLang" data-bs-toggle="dropdown" aria-expanded="false">
                            <span id="currentLang">EN</span>
                        </a>
                        <ul class="dropdown-menu dropdown-menu-light text-small shadow" aria-labelledby="dropdownLang">
                            <li><a class="dropdown-item" href="#" onclick="setLanguage('en')">English</a></li>
                            <li><a class="dropdown-item" href="#" onclick="setLanguage('ar')">العربية</a></li>
                        </ul>
                    </div>
                </div>
            </nav>

            <!-- Main Content -->
            <div class="col py-3">
                <!-- Customers Section -->
                <section id="section-customers">
                    <h2 data-lang="customersHeader">Customer Management</h2>
                    <div class="row mb-3">
                        <div class="col-md-4">
                            <input type="text" id="searchCustomerInput" class="form-control" placeholder="Search" oninput="searchCustomers()">
                        </div>
                        <div class="col-md-auto">
                            <button class="btn btn-primary" onclick="showCustomerForm()" data-lang="btnAddCustomer">Add Customer</button>
                        </div>
                    </div>
                    <div class="table-responsive">
                        <table class="table table-striped" id="customersTable">
                            <thead>
                                <tr>
                                    <th>ID</th>
                                    <th data-lang="thName">Name</th>
                                    <th data-lang="thPhone">Phone</th>
                                    <th data-lang="thActions">Actions</th>
                                </tr>
                            </thead>
                            <tbody id="customersTableBody">
                                <!-- Populated via JS -->
                            </tbody>
                        </table>
                    </div>
                </section>

                <!-- Services Section -->
                <section id="section-services" class="d-none">
                    <h2 data-lang="servicesHeader">Service Management</h2>
                    <div class="row mb-3">
                        <div class="col-md-4">
                            <input type="text" id="searchServiceInput" class="form-control" placeholder="Search" oninput="searchServices()">
                        </div>
                        <div class="col-md-auto">
                            <button class="btn btn-primary" onclick="showServiceForm()" data-lang="btnAddService">Add Service</button>
                        </div>
                    </div>
                    <div class="table-responsive">
                        <table class="table table-striped" id="servicesTable">
                            <thead>
                                <tr>
                                    <th>ID</th>
                                    <th data-lang="thServiceName">Service Name</th>
                                    <th data-lang="thPrice">Price</th>
                                    <th data-lang="thActions">Actions</th>
                                </tr>
                            </thead>
                            <tbody id="servicesTableBody">
                                <!-- Populated via JS -->
                            </tbody>
                        </table>
                    </div>
                </section>

                <!-- Visits Section -->
                <section id="section-visits" class="d-none">
                    <h2 data-lang="visitsHeader">Visit Management</h2>
                    <div class="row mb-3">
                        <div class="col-md-4">
                            <input type="text" id="searchVisitInput" class="form-control" placeholder="Search" oninput="searchVisits()">
                        </div>
                        <div class="col-md-auto">
                            <button class="btn btn-primary" onclick="showVisitForm()" data-lang="btnNewVisit">New Visit</button>
                        </div>
                    </div>
                    <div class="table-responsive">
                        <table class="table table-striped" id="visitsTable">
                            <thead>
                                <tr>
                                    <th>ID</th>
                                    <th data-lang="thCustomer">Customer</th>
                                    <th data-lang="thServices">Services</th>
                                    <th data-lang="thStatus">Status</th>
                                    <th data-lang="thDates">Dates</th>
                                    <th data-lang="thActions">Actions</th>
                                </tr>
                            </thead>
                            <tbody id="visitsTableBody">
                                <!-- Populated via JS -->
                            </tbody>
                        </table>
                    </div>
                </section>

                <!-- Reports Section -->
                <section id="section-reports" class="d-none">
                    <h2 data-lang="reportsHeader">Reports</h2>
                    <div class="row mb-3">
                        <div class="col-md-3">
                            <select id="reportType" class="form-select" onchange="generateReport()">
                                <option value="daily" data-lang="reportDaily">Daily</option>
                                <option value="weekly" data-lang="reportWeekly">Weekly</option>
                                <option value="monthly" data-lang="reportMonthly">Monthly</option>
                                <option value="yearly" data-lang="reportYearly">Yearly</option>
                            </select>
                        </div>
                        <div class="col-md-4">
                            <input type="date" id="reportStartDate" class="form-control" onchange="generateReport()">
                        </div>
                        <div class="col-md-4">
                            <input type="date" id="reportEndDate" class="form-control" onchange="generateReport()">
                        </div>
                        <div class="col-md-auto">
                            <button class="btn btn-primary" onclick="generateReport()" data-lang="btnGenerateReport">Generate</button>
                        </div>
                    </div>
                    <div id="reportContent" class="table-responsive">
                        <!-- Report output -->
                    </div>
                </section>
            </div>
        </div>
    </div>

    <!-- Modals for forms -->
    <!-- Customer Form Modal -->
    <div class="modal fade" id="customerModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="customerModalTitle" data-lang="modalAddCustomer">Add Customer</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="customerForm">
                        <div class="mb-3">
                            <label for="customerName" class="form-label" data-lang="labelName">Name</label>
                            <input type="text" class="form-control" id="customerName" required>
                        </div>
                        <div class="mb-3">
                            <label for="customerPhone" class="form-label" data-lang="labelPhone">Phone</label>
                            <input type="tel" class="form-control" id="customerPhone" required>
                        </div>
                        <input type="hidden" id="customerId">
                        <button type="submit" class="btn btn-primary" data-lang="btnSave">Save</button>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <!-- Service Form Modal -->
    <div class="modal fade" id="serviceModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="serviceModalTitle" data-lang="modalAddService">Add Service</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="serviceForm">
                        <div class="mb-3">
                            <label for="serviceName" class="form-label" data-lang="labelServiceName">Service Name</label>
                            <input type="text" class="form-control" id="serviceName" required>
                        </div>
                        <div class="mb-3">
                            <label for="servicePrice" class="form-label" data-lang="labelPrice">Price</label>
                            <input type="number" class="form-control" id="servicePrice" min="0" step="0.01" required>
                        </div>
                        <input type="hidden" id="serviceId">
                        <button type="submit" class="btn btn-primary" data-lang="btnSave">Save</button>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <!-- Visit Form Modal -->
    <div class="modal fade" id="visitModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="visitModalTitle" data-lang="modalNewVisit">New Visit</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="visitForm">
                        <div class="mb-3">
                            <label for="visitCustomer" class="form-label" data-lang="labelCustomer">Customer</label>
                            <select id="visitCustomer" class="form-select" required></select>
                        </div>
                        <div class="mb-3">
                            <label class="form-label" data-lang="labelServices">Services</label>
                            <div id="visitServicesList" class="mb-2">
                                <!-- Service checkboxes with quantity fields will be inserted here -->
                            </div>
                        </div>
                        <div class="row mb-3">
                            <div class="col-md-4">
                                <label for="visitDiscount" class="form-label" data-lang="labelDiscount">Discount (%)</label>
                                <input type="number" id="visitDiscount" class="form-control" min="0" max="100" value="0">
                            </div>
                            <div class="col-md-4">
                                <label for="visitUrgentMultiplier" class="form-label" data-lang="labelUrgentMultiplier">Urgent Multiplier</label>
                                <input type="number" id="visitUrgentMultiplier" class="form-control" min="1" max="3" step="0.5" value="1">
                            </div>
                            <div class="col-md-4">
                                <label for="visitVAT" class="form-label" data-lang="labelVAT">VAT (%)</label>
                                <input type="number" id="visitVAT" class="form-control" min="0" max="100" value="5">
                            </div>
                        </div>
                        <button type="submit" class="btn btn-primary" data-lang="btnSaveVisit">Save Visit</button>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <!-- Invoice Modal -->
    <div class="modal fade" id="invoiceModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" data-lang="modalInvoice">Invoice</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div id="invoiceContent">
                        <!-- Invoice HTML will be injected here -->
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-secondary" onclick="window.print()" data-lang="btnPrint">Print</button>
                    <button class="btn btn-primary" onclick="sendInvoice()" data-lang="btnSend">Send</button>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/js/bootstrap.bundle.min.js"></script>
    <script type="module" src="firebase-config.js"></script>
    <script type="module" src="main.js"></script>
</body>
</html>